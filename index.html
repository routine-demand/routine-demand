<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>例行生活需求紀錄</title>
<script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
<style>
body { font-family: Arial, sans-serif; max-width: 700px; margin: 40px auto; line-height: 1.6; padding: 0 20px; }
h1 { color: #2c3e50; }
a.button { display:inline-block; padding:10px 20px; background:#3498db; color:white; text-decoration:none; border-radius:5px; }
a.button:hover { background:#2980b9; }
form { margin-top:20px; margin-bottom:30px; }
input, select, textarea, button { width: 100%; padding:8px; margin:4px 0; box-sizing:border-box; }
button { background:#3498db; color:white; border:none; border-radius:5px; cursor:pointer; }
button:hover { background:#2980b9; }
table { width:100%; border-collapse: collapse; margin-top:20px; }
th, td { border:1px solid #ccc; padding:8px; text-align:left; }
th { background:#f5f5f5; }
</style>
</head>
<body>

<h1>例行生活需求紀錄</h1>
<p>歡迎填寫你的例行生活或辦公消耗品需求，提交後會即時顯示在下方表格，讓供應商了解需求量。</p>

<h2>填寫需求</h2>
<form id="demandForm" target="_blank" action="https://docs.google.com/forms/d/e/你的GoogleFormID/formResponse" method="POST">
  <label>身份（選填）：</label>
  <select name="entry.123456" >
    <option value="">請選擇</option>
    <option>小型辦公室 / 工作室</option>
    <option>家庭</option>
    <option>其他</option>
  </select>

  <label>地區：</label>
  <input type="text" name="entry.234567" placeholder="例如：台北市">

  <label>物品名稱：</label>
  <input type="text" name="entry.345678" placeholder="例如：衛生紙" required>

  <label>數量：</label>
  <input type="number" name="entry.456789" min="1" required>

  <label>購買頻率：</label>
  <select name="entry.567890" required>
    <option value="">請選擇</option>
    <option>每日</option>
    <option>每週</option>
    <option>每月</option>
    <option>不固定</option>
  </select>

  <button type="submit">提交需求</button>
</form>

<h2>即時需求表</h2>
<table id="demandTable">
<thead>
<tr><th>身份</th><th>地區</th><th>物品</th><th>數量</th><th>頻率</th><th>時間</th></tr>
</thead>
<tbody></tbody>
</table>

<script>
// 你的 Google Sheet CSV 連結
const sheetCsvUrl = "你的GoogleSheet CSV連結";

// 讀取 Google Sheet 資料並更新表格
function loadSheet(){
  Papa.parse(sheetCsvUrl, {
    download: true,
    header: true,
    complete: function(results){
      const tbody = document.querySelector("#demandTable tbody");
      tbody.innerHTML = "";
      results.data.forEach(row => {
        if(row.物品){
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${row.身份 || "-"}</td>
            <td>${row.地區 || "-"}</td>
            <td>${row.物品}</td>
            <td>${row.數量}</td>
            <td>${row.頻率}</td>
            <td>${row.時間 || "-"}</td>
          `;
          tbody.appendChild(tr);
        }
      });
    }
  });
}

// 初次載入
loadSheet();

// 每 30 秒自動刷新表格
setInterval(loadSheet, 30000);
</script>

<p style="font-size:0.9em; color: #555; margin-top:30px;">
免責聲明：本表單僅收集「例行需求」資訊，非購物或訂單平台，填寫不代表任何交易承諾，所有資料僅作匿名統計與實驗用途。
</p>

</body>
</html>
